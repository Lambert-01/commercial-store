<%- include('../partials/header') %>

<!-- Order Details Section -->
<section style="padding: var(--space-16) 0;">
  <div class="container">
    <div style="max-width: 800px; margin: 0 auto;">
      <!-- Order Header -->
      <div class="card" style="padding: var(--space-8); margin-bottom: var(--space-8);">
        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: var(--space-6);">
          <div>
            <h1 style="font-size: var(--font-size-3xl); font-weight: var(--font-weight-bold); color: var(--color-gray-900); margin-bottom: var(--space-2);">
              Order #<%= order._id.toString().slice(-8) %>
            </h1>
            <p style="color: var(--color-gray-600); font-size: var(--font-size-base);">
              Placed on <%= new Date(order.createdAt).toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
              }) %>
            </p>
          </div>

          <div style="text-align: right;">
            <span class="status-badge <%= order.status === 'delivered' ? 'status-badge--approved' : order.status === 'shipped' ? 'status-badge--active' : order.status === 'pending' ? 'status-badge--pending' : 'status-badge--rejected' %>">
              <%= order.status.charAt(0).toUpperCase() + order.status.slice(1) %>
            </span>
            <p style="font-size: var(--font-size-2xl); font-weight: var(--font-weight-bold); color: var(--color-primary); margin-top: var(--space-2);">
              <%= order.total %> RWF
            </p>
          </div>
        </div>

        <!-- Shipping Address -->
        <div style="background: var(--color-gray-50); padding: var(--space-6); border-radius: var(--radius-lg); margin-bottom: var(--space-6);">
          <h3 style="font-size: var(--font-size-lg); font-weight: var(--font-weight-semibold); margin-bottom: var(--space-3); color: var(--color-gray-900);">
            üöö Shipping Address
          </h3>
          <p style="color: var(--color-gray-700); margin: 0;">
            <%= order.shippingAddress.address %><br>
            <%= order.shippingAddress.city %>, <%= order.shippingAddress.country %>
          </p>
        </div>

        <!-- Order Items -->
        <div>
          <h3 style="font-size: var(--font-size-lg); font-weight: var(--font-weight-semibold); margin-bottom: var(--space-4); color: var(--color-gray-900);">
            üì¶ Order Items
          </h3>

          <div>
            <% order.items.forEach(item => { %>
              <div style="display: flex; justify-content: space-between; align-items: center; padding: var(--space-4); border: 1px solid var(--color-gray-200); border-radius: var(--radius-md);">
                <div style="display: flex; align-items: center; gap: var(--space-4);">
                  <div style="width: 60px; height: 60px; background: var(--color-gray-200); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center; font-size: var(--font-size-xl);">
                    üì¶
                  </div>
                  <div>
                    <h4 style="font-size: var(--font-size-base); font-weight: var(--font-weight-medium); color: var(--color-gray-900); margin-bottom: var(--space-1);">
                      <%= item.product.name %>
                    </h4>
                    <p style="font-size: var(--font-size-sm); color: var(--color-gray-600);">
                      Quantity: <%= item.quantity %>
                    </p>
                  </div>
                </div>
                <div style="text-align: right;">
                  <p style="font-size: var(--font-size-base); font-weight: var(--font-weight-semibold); color: var(--color-primary);">
                    <%= item.price * item.quantity %> RWF
                  </p>
                  <p style="font-size: var(--font-size-sm); color: var(--color-gray-600);">
                    <%= item.price %> RWF each
                  </p>
                </div>
              </div>
            <% }); %>
          </div>
        </div>

        <!-- Order Summary -->
        <div style="background: var(--color-primary-light); padding: var(--space-6); border-radius: var(--radius-lg); margin-top: var(--space-6);">
          <div style="display: flex; justify-content: space-between; align-items: center;">
            <span style="font-size: var(--font-size-lg); font-weight: var(--font-weight-bold); color: var(--color-primary-dark);">
              Order Total:
            </span>
            <span style="font-size: var(--font-size-2xl); font-weight: var(--font-weight-bold); color: var(--color-primary-dark);">
              <%= order.total %> RWF
            </span>
          </div>
        </div>
      </div>

      <!-- Order Actions -->
      <div style="display: flex; gap: var(--space-4); justify-content: center;">
        <a href="/orders/history" class="btn btn--outline">
          ‚¨ÖÔ∏è Back to Orders
        </a>
        <% if (order.status === 'delivered') { %>
          <button class="btn btn--primary" onclick="reorder('<%= order._id %>')">
            üîÑ Order Again
          </button>
        <% } %>
        <button class="btn btn--secondary" onclick="printOrder('<%= order._id %>')">
          üñ®Ô∏è Print Receipt
        </button>
      </div>
    </div>
  </div>
</section>

<%- include('../partials/footer') %>