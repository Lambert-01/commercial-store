<%- include('../partials/header') %>

<!-- Enhanced Login Section with Premium Rwandan Design & Starry Night Theme -->
<section class="min-h-screen flex items-center justify-center py-16 hero-starry relative overflow-hidden">
  <!-- Nebula Overlay -->
  <div class="nebula-overlay"></div>

  <!-- Animated Background Elements -->
  <div class="absolute inset-0 opacity-20">
    <div class="absolute top-10 left-10 text-6xl animate-pulse">ğŸ‡·ğŸ‡¼</div>
    <div class="absolute bottom-10 right-10 text-5xl animate-pulse">ğŸ›’</div>
    <div class="absolute top-1/2 left-1/4 text-4xl animate-bounce">ğŸª</div>
    <div class="absolute bottom-1/4 right-1/4 text-3xl animate-float">ğŸ’³</div>
  </div>

  <div class="container mx-auto px-4 relative z-10">
    <div class="max-w-md mx-auto">
      <!-- Premium Glassmorphism Login Card -->
      <div class="glass-card rounded-3xl p-8 animate__animated animate__fadeInUp max-w-lg mx-auto"
            data-aos="zoom-in">

        <!-- Brand Header -->
        <div class="text-center mb-8">
          <div class="flex items-center justify-center gap-3 mb-4">
            <div class="w-16 h-16 bg-gradient-to-br from-rwandan-yellow-500 to-yellow-500 rounded-2xl flex items-center justify-center text-2xl shadow-lg animate-glow">
              ğŸ‡·ğŸ‡¼
            </div>
            <div class="text-left">
              <h1 class="text-2xl md:text-3xl font-bold gradient-text-primary">
                Ecommerce Rwanda
              </h1>
              <p class="text-sm text-slate-300">Multi-Vendor Marketplace</p>
            </div>
          </div>

          <div class="w-16 h-16 bg-gradient-to-br from-primary to-primary-600 mx-auto mb-4 rounded-full flex items-center justify-center text-3xl shadow-lg animate-pulse">
            ğŸ”‘
          </div>
          <h2 class="text-2xl md:text-3xl font-bold gradient-text-rainbow mb-2 text-glow-primary">
            Welcome Back
          </h2>
          <p class="text-slate-300">
            Sign in to access your account
          </p>
        </div>

        <!-- Error Message -->
        <% if (typeof error !== 'undefined' && error) { %>
          <div class="bg-red-500/20 border border-red-400/30 text-red-300 p-4 rounded-lg mb-6 text-sm animate__animated animate__shake glass-panel"
               data-aos="shake">
            âš ï¸ <%= error %>
          </div>
        <% } %>

        <!-- Success Message -->
        <% if (typeof success !== 'undefined' && success) { %>
          <div class="bg-green-500/20 border border-green-400/30 text-green-300 p-4 rounded-lg mb-6 text-sm glass-panel">
            âœ… <%= success %>
          </div>
        <% } %>

        <!-- Login Form -->
        <form action="/login" method="POST" class="space-y-6">
          <div>
            <label for="email" class="block text-sm font-medium text-slate-300 mb-2">
              Email Address
            </label>
            <div class="relative">
              <input type="email"
                     id="email"
                     name="email"
                     placeholder="Enter your email address"
                     class="form-input-rwanda w-full pl-10 bg-slate-800/50 border-slate-600 text-white placeholder-slate-400 focus:border-primary"
                     required>
              <span class="absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400">ğŸ“§</span>
            </div>
          </div>

          <div>
            <label for="password" class="block text-sm font-medium text-slate-300 mb-2">
              Password
            </label>
            <div class="relative">
              <input type="password"
                     id="password"
                     name="password"
                     placeholder="Enter your password"
                     class="form-input-rwanda w-full pl-10 bg-slate-800/50 border-slate-600 text-white placeholder-slate-400 focus:border-primary"
                     required>
              <span class="absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400">ğŸ”’</span>
            </div>
          </div>

          <!-- Remember Me & Forgot Password -->
          <div class="flex items-center justify-between">
            <label class="flex items-center">
              <input type="checkbox"
                     name="rememberMe"
                     class="rounded border-neutral-300 text-primary focus:ring-primary">
              <span class="ml-2 text-sm text-neutral-600">Remember me</span>
            </label>
            <a href="/forgot-password"
               class="text-sm text-primary hover:text-primary-600 transition-colors duration-200">
              Forgot password?
            </a>
          </div>

          <button type="submit"
                  class="btn-neon w-full text-lg py-3">
            ğŸ”‘ Sign In to Your Account
          </button>

          <div class="text-center">
            <a href="/register"
               class="gradient-text-secondary hover:scale-105 font-medium transition-all duration-200 inline-block">
              Don't have an account? Create one here
           </a>
          </div>
        </form>

        <!-- Demo Login Options -->
        <div class="mt-8 space-y-4">
          <div class="text-center">
            <p class="text-neutral-600 text-sm mb-4">ğŸš€ Quick Demo Access:</p>
          </div>

          <!-- Demo Login Buttons -->
          <div class="grid grid-cols-1 gap-3">
            <button onclick="demoLogin('customer')"
                    class="btn-gradient-primary font-medium py-3 px-6 text-center">
              ğŸ›ï¸ Try as Customer
            </button>
            <button onclick="demoLogin('supplier')"
                    class="btn-gradient-secondary font-medium py-3 px-6 text-center">
              ğŸª Try as Supplier
            </button>
            <button onclick="demoLogin('admin')"
                    class="bg-gradient-to-r from-red-500 to-red-700 hover:from-red-600 hover:to-red-800 text-white font-medium py-3 px-6 text-center btn-floating">
              ğŸ‘‘ Try as Admin
            </button>
          </div>

          <!-- Demo Credentials Info -->
          <div class="mt-6 p-4 glass-panel rounded-lg border border-white/20">
            <h4 class="text-sm font-semibold gradient-text-primary mb-3 flex items-center gap-2">
              <span>ğŸš€</span>
              Demo Credentials
            </h4>
            <div class="space-y-2 text-xs">
              <div class="flex items-center gap-2">
                <span class="gradient-text-secondary font-medium">Customer:</span>
                <button onclick="fillDemoCredentials('customer@customer.rw', 'customer123')"
                        class="gradient-text-accent hover:scale-105 underline transition-all duration-200">
                  customer@customer.rw
                </button>
              </div>
              <div class="flex items-center gap-2">
                <span class="gradient-text-secondary font-medium">Supplier:</span>
                <button onclick="fillDemoCredentials('supplier@kigalicoffee.rw', 'supplier123')"
                        class="gradient-text-accent hover:scale-105 underline transition-all duration-200">
                  supplier@kigalicoffee.rw
                </button>
              </div>
              <div class="flex items-center gap-2">
                <span class="gradient-text-secondary font-medium">Admin:</span>
                <button onclick="fillDemoCredentials('admin@ecommerce.rw', 'admin123')"
                        class="gradient-text-accent hover:scale-105 underline transition-all duration-200">
                  admin@ecommerce.rw
                </button>
              </div>
              <p class="text-slate-400 text-xs mt-2">
                ğŸ’¡ Click any demo email to auto-fill the login form
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Enhanced Login JavaScript -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  // Demo login functionality
  window.demoLogin = function(role) {
    const credentials = {
      customer: { email: 'customer@customer.rw', password: 'customer123' },
      supplier: { email: 'supplier@kigalicoffee.rw', password: 'supplier123' },
      admin: { email: 'admin@ecommerce.rw', password: 'admin123' }
    };

    const creds = credentials[role];
    if (creds) {
      fillDemoCredentials(creds.email, creds.password);

      // Auto-submit after a short delay
      setTimeout(() => {
        document.querySelector('form').submit();
      }, 500);
    }
  };

  // Fill demo credentials
  window.fillDemoCredentials = function(email, password) {
    document.getElementById('email').value = email;
    document.getElementById('password').value = password;
    document.getElementById('email').focus();
  };

  // Password visibility toggle
  const passwordInput = document.getElementById('password');
  const togglePassword = document.createElement('button');
  togglePassword.type = 'button';
  togglePassword.innerHTML = 'ğŸ‘ï¸';
  togglePassword.className = 'absolute right-3 top-1/2 transform -translate-y-1/2 text-neutral-400 hover:text-neutral-600 transition-colors duration-200';

  if (passwordInput) {
    passwordInput.parentNode.appendChild(togglePassword);

    togglePassword.addEventListener('click', function() {
      if (passwordInput.type === 'password') {
        passwordInput.type = 'text';
        this.innerHTML = 'ğŸ™ˆ';
      } else {
        passwordInput.type = 'password';
        this.innerHTML = 'ğŸ‘ï¸';
      }
    });
  }

  // Form validation
  const loginForm = document.querySelector('form');
  if (loginForm) {
    loginForm.addEventListener('submit', function(e) {
      const email = document.getElementById('email').value.trim();
      const password = document.getElementById('password').value.trim();

      if (!email || !password) {
        e.preventDefault();
        showToast('Please enter both email and password', 'error');
        return;
      }

      if (!isValidEmail(email)) {
        e.preventDefault();
        showToast('Please enter a valid email address', 'error');
        return;
      }
    });
  }

  function isValidEmail(email) {
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return emailRegex.test(email);
  }

  function showToast(message, type = 'info') {
    const toast = document.createElement('div');
    toast.className = `fixed top-4 right-4 px-6 py-3 rounded-lg text-white z-50 transition-all duration-300 transform translate-x-full`;
    toast.style.backgroundColor = type === 'error' ? '#ef4444' : type === 'success' ? '#00a86b' : '#3b82f6';
    toast.textContent = message;

    document.body.appendChild(toast);

    // Animate in
    setTimeout(() => {
      toast.style.transform = 'translateX(0)';
    }, 100);

    // Remove after 3 seconds
    setTimeout(() => {
      toast.style.transform = 'translateX(full)';
      setTimeout(() => {
        toast.remove();
      }, 300);
    }, 3000);
  }

  // Check for success message in URL
  const urlParams = new URLSearchParams(window.location.search);
  const successMessage = urlParams.get('success');
  if (successMessage) {
    showToast(successMessage, 'success');

    // Clean URL
    const newUrl = window.location.pathname;
    window.history.replaceState({}, document.title, newUrl);
  }
});
</script>

<%- include('../partials/footer') %>