<%- include('../partials/header') %>

<!-- Order History Section -->
<section style="padding: var(--space-16) 0;">
  <div class="container">
    <!-- Page Header -->
    <div style="text-align: center; margin-bottom: var(--space-12);">
      <h1 style="font-size: var(--font-size-4xl); font-weight: var(--font-weight-bold); color: var(--color-gray-900); margin-bottom: var(--space-4);">
        ğŸ“‹ Order History
      </h1>
      <p style="font-size: var(--font-size-lg); color: var(--color-gray-600);">
        Track your orders and view order details
      </p>
    </div>

    <% if (orders && orders.length > 0) { %>
      <div style="display: grid; gap: var(--space-6);">
        <% orders.forEach(order => { %>
          <div class="card" style="padding: var(--space-6);">
            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: var(--space-4);">
              <div>
                <h3 style="font-size: var(--font-size-xl); font-weight: var(--font-weight-semibold); color: var(--color-gray-900); margin-bottom: var(--space-2);">
                  Order #<%= order._id.toString().slice(-8) %>
                </h3>
                <p style="color: var(--color-gray-600); font-size: var(--font-size-sm);">
                  Placed on <%= new Date(order.createdAt).toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                  }) %>
                </p>
              </div>

              <div style="text-align: right;">
                <span class="status-badge <%= order.status === 'delivered' ? 'status-badge--approved' : order.status === 'shipped' ? 'status-badge--active' : order.status === 'pending' ? 'status-badge--pending' : 'status-badge--rejected' %>">
                  <%= order.status.charAt(0).toUpperCase() + order.status.slice(1) %>
                </span>
                <p style="font-size: var(--font-size-lg); font-weight: var(--font-weight-bold); color: var(--color-primary); margin-top: var(--space-2);">
                  <%= order.total %> RWF
                </p>
              </div>
            </div>

            <!-- Order Items Preview -->
            <div style="margin-bottom: var(--space-4);">
              <p style="font-size: var(--font-size-sm); color: var(--color-gray-600); margin-bottom: var(--space-2);">
                Items: <%= order.items.reduce((total, item) => total + item.quantity, 0) %> product(s)
              </p>
              <div style="display: flex; gap: var(--space-2); flex-wrap: wrap;">
                <% order.items.slice(0, 3).forEach(item => { %>
                  <span style="background: var(--color-gray-100); padding: var(--space-1) var(--space-3); border-radius: var(--radius-full); font-size: var(--font-size-xs); color: var(--color-gray-700);">
                    <%= item.product.name %> (Ã—<%= item.quantity %>)
                  </span>
                <% }); %>
                <% if (order.items.length > 3) { %>
                  <span style="background: var(--color-gray-100); padding: var(--space-1) var(--space-3); border-radius: var(--radius-full); font-size: var(--font-size-xs); color: var(--color-gray-700);">
                    +<%= order.items.length - 3 %> more
                  </span>
                <% } %>
              </div>
            </div>

            <!-- Order Actions -->
            <div style="display: flex; gap: var(--space-3);">
              <a href="/orders/details/<%= order._id %>" class="btn btn--outline" style="flex: 1;">
                ğŸ‘ï¸ View Details
              </a>
              <% if (order.status === 'delivered') { %>
                <button class="btn btn--secondary" onclick="reorder('<%= order._id %>')">
                  ğŸ”„ Reorder
                </button>
              <% } %>
            </div>
          </div>
        <% }); %>
      </div>
    <% } else { %>
      <!-- Empty State -->
      <div style="text-align: center; padding: var(--space-20) 0;">
        <div style="font-size: var(--font-size-4xl); margin-bottom: var(--space-6);">ğŸ›’</div>
        <h2 style="font-size: var(--font-size-2xl); color: var(--color-gray-900); margin-bottom: var(--space-4);">
          No Orders Yet
        </h2>
        <p style="font-size: var(--font-size-lg); color: var(--color-gray-600); margin-bottom: var(--space-8);">
          Start shopping to see your order history here.
        </p>
        <a href="/products" class="btn btn--primary">
          ğŸ›ï¸ Start Shopping
        </a>
      </div>
    <% } %>
  </div>
</section>

<%- include('../partials/footer') %>