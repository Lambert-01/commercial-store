<%- include('../partials/header') %>

<!-- Client Dashboard Section with Rwandan Design System -->
<section class="py-12 bg-neutral-50 min-h-screen" data-aos="fade-up">
  <div class="container mx-auto px-4">
    <!-- Dashboard Header -->
    <div class="mb-8" data-aos="fade-up" data-aos-delay="100">
      <div class="flex items-center gap-4 mb-4">
        <div class="w-16 h-16 bg-primary bg-opacity-10 rounded-full flex items-center justify-center text-3xl">
          🛍️
        </div>
        <div>
          <h1 class="text-3xl md:text-4xl font-bold text-neutral-900">
            Welcome back, <%= typeof user !== 'undefined' && user.name ? user.name : 'Customer' %>!
          </h1>
          <p class="text-neutral-600 text-lg">
            Manage your orders and discover amazing Rwandan products
          </p>
        </div>
      </div>
    </div>

    <!-- Quick Stats -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8" data-aos="fade-up" data-aos-delay="200">
      <div class="bg-white rounded-xl shadow-lg p-6 text-center">
        <div class="w-12 h-12 bg-primary bg-opacity-10 rounded-full flex items-center justify-center text-2xl mx-auto mb-4">
          📦
        </div>
        <h3 class="text-2xl font-bold text-neutral-900 mb-2"><%= typeof orderStats !== 'undefined' ? orderStats.totalOrders : 0 %></h3>
        <p class="text-neutral-600">Total Orders</p>
      </div>

      <div class="bg-white rounded-xl shadow-lg p-6 text-center">
        <div class="w-12 h-12 bg-success bg-opacity-10 rounded-full flex items-center justify-center text-2xl mx-auto mb-4">
          ✅
        </div>
        <h3 class="text-2xl font-bold text-neutral-900 mb-2"><%= typeof orderStats !== 'undefined' ? orderStats.deliveredOrders : 0 %></h3>
        <p class="text-neutral-600">Delivered Orders</p>
      </div>

      <div class="bg-white rounded-xl shadow-lg p-6 text-center">
        <div class="w-12 h-12 bg-warning bg-opacity-10 rounded-full flex items-center justify-center text-2xl mx-auto mb-4">
          ⏳
        </div>
        <h3 class="text-2xl font-bold text-neutral-900 mb-2"><%= typeof orderStats !== 'undefined' ? orderStats.pendingOrders : 0 %></h3>
        <p class="text-neutral-600">Pending Orders</p>
      </div>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
      <!-- Recent Orders -->
      <div class="bg-white rounded-xl shadow-lg p-8" data-aos="fade-right" data-aos-delay="300">
        <h2 class="text-2xl font-bold text-neutral-900 mb-6 flex items-center gap-3">
          <span>📋</span>
          Recent Orders
        </h2>

        <% if (typeof recentOrders !== 'undefined' && recentOrders.length > 0) { %>
          <div class="space-y-4">
            <% recentOrders.slice(0, 3).forEach(order => { %>
              <div class="border border-neutral-200 rounded-lg p-4 hover:shadow-md transition-shadow duration-200">
                <div class="flex items-center justify-between mb-3">
                  <div>
                    <h4 class="font-semibold text-neutral-900">
                      Order #<%= order._id.toString().slice(-8) %>
                    </h4>
                    <p class="text-sm text-neutral-600">
                      <%= new Date(order.createdAt).toLocaleDateString() %>
                    </p>
                  </div>
                  <div class="text-right">
                    <span class="status-badge <%= order.status === 'delivered' ? 'status-badge--approved' : order.status === 'shipped' ? 'status-badge--active' : order.status === 'pending' ? 'status-badge--pending' : 'status-badge--rejected' %>">
                      <%= order.status.charAt(0).toUpperCase() + order.status.slice(1) %>
                    </span>
                    <p class="text-lg font-bold text-primary mt-1">
                      <%= order.total %> RWF
                    </p>
                  </div>
                </div>
                <a href="/orders/details/<%= order._id %>"
                   class="text-primary hover:text-primary-600 text-sm font-medium">
                  View Details →
                </a>
              </div>
            <% }); %>
          </div>

          <div class="text-center mt-6">
            <a href="/orders/history"
               class="btn-rwanda-secondary">
              📋 View All Orders
            </a>
          </div>
        <% } else { %>
          <div class="text-center py-8">
            <div class="w-16 h-16 bg-neutral-200 rounded-full flex items-center justify-center text-2xl mx-auto mb-4">
              📦
            </div>
            <h3 class="text-lg font-semibold text-neutral-900 mb-2">No Orders Yet</h3>
            <p class="text-neutral-600 mb-4">Start shopping to see your orders here</p>
            <a href="/products"
               class="btn-rwanda">
              🛍️ Start Shopping
            </a>
          </div>
        <% } %>
      </div>

      <!-- Quick Actions -->
      <div class="bg-white rounded-xl shadow-lg p-8" data-aos="fade-left" data-aos-delay="400">
        <h2 class="text-2xl font-bold text-neutral-900 mb-6 flex items-center gap-3">
          <span>⚡</span>
          Quick Actions
        </h2>

        <div class="space-y-4">
          <a href="/products"
             class="flex items-center gap-4 p-4 bg-primary bg-opacity-5 rounded-lg hover:bg-primary hover:bg-opacity-10 transition-all duration-200 group">
            <div class="w-12 h-12 bg-primary bg-opacity-10 group-hover:bg-primary group-hover:bg-opacity-20 rounded-full flex items-center justify-center text-xl">
              🛍️
            </div>
            <div>
              <h3 class="font-semibold text-neutral-900 group-hover:text-primary">Browse Products</h3>
              <p class="text-sm text-neutral-600">Discover amazing Rwandan products</p>
            </div>
          </a>

          <a href="/cart"
             class="flex items-center gap-4 p-4 bg-secondary bg-opacity-5 rounded-lg hover:bg-secondary hover:bg-opacity-10 transition-all duration-200 group">
            <div class="w-12 h-12 bg-secondary bg-opacity-10 group-hover:bg-secondary group-hover:bg-opacity-20 rounded-full flex items-center justify-center text-xl">
              🛒
            </div>
            <div>
              <h3 class="font-semibold text-neutral-900 group-hover:text-secondary-600">View Cart</h3>
              <p class="text-sm text-neutral-600">Check your shopping cart</p>
            </div>
          </a>

          <a href="/profile"
             class="flex items-center gap-4 p-4 bg-accent bg-opacity-5 rounded-lg hover:bg-accent hover:bg-opacity-10 transition-all duration-200 group">
            <div class="w-12 h-12 bg-accent bg-opacity-10 group-hover:bg-accent group-hover:bg-opacity-20 rounded-full flex items-center justify-center text-xl">
              👤
            </div>
            <div>
              <h3 class="font-semibold text-neutral-900 group-hover:text-accent-600">My Profile</h3>
              <p class="text-sm text-neutral-600">Manage your account settings</p>
            </div>
          </a>

          <a href="/suppliers"
             class="flex items-center gap-4 p-4 bg-success bg-opacity-5 rounded-lg hover:bg-success hover:bg-opacity-10 transition-all duration-200 group">
            <div class="w-12 h-12 bg-success bg-opacity-10 group-hover:bg-success group-hover:bg-opacity-20 rounded-full flex items-center justify-center text-xl">
              🏪
            </div>
            <div>
              <h3 class="font-semibold text-neutral-900 group-hover:text-success">Browse Suppliers</h3>
              <p class="text-sm text-neutral-600">Find trusted local suppliers</p>
            </div>
          </a>
        </div>
      </div>
    </div>

    <!-- Featured Products -->
    <div class="mt-12" data-aos="fade-up" data-aos-delay="500">
      <h2 class="text-2xl md:text-3xl font-bold text-neutral-900 mb-8 text-center">
        🔥 Featured Products
      </h2>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
        <% if (typeof featuredProducts !== 'undefined' && featuredProducts.length > 0) { %>
          <% featuredProducts.slice(0, 4).forEach((product, index) => { %>
            <div class="product-card bg-white rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-2 border border-neutral-200 overflow-hidden animate__animated animate__fadeInUp group"
                 data-aos="fade-up"
                 data-aos-delay="<%= 600 + (index * 100) %>"
                 style="animation-delay: <%= index * 0.1 %>s;">

              <!-- Product Image -->
              <div class="relative h-48 bg-gradient-to-br from-neutral-200 to-neutral-300 flex items-center justify-center text-6xl overflow-hidden">
                📦
                <div class="absolute top-3 right-3 bg-success text-white px-2 py-1 rounded-full text-xs font-bold">
                  🔥 Featured
                </div>
              </div>

              <!-- Product Info -->
              <div class="p-5">
                <h3 class="text-lg font-bold text-neutral-900 mb-2 line-clamp-2">
                  <%= product.name %>
                </h3>
                <p class="text-neutral-600 text-sm mb-4 line-clamp-2">
                  <%= product.description %>
                </p>

                <div class="flex items-center justify-between mb-4">
                  <div class="text-2xl font-bold text-rwanda-yellow">
                    <%= product.price.toLocaleString() %> RWF
                  </div>
                  <div class="text-sm text-success font-medium">
                    <%= product.stock %> available
                  </div>
                </div>

                <div class="flex gap-2">
                  <a href="/product/<%= product._id %>"
                     class="flex-1 bg-primary hover:bg-primary-600 text-white text-center py-2 px-4 rounded-lg transition-colors duration-200 text-sm font-medium">
                    View Details
                  </a>

                  <% if (isAuthenticated) { %>
                    <form method="POST" action="/cart/add" class="inline">
                      <input type="hidden" name="productId" value="<%= product._id %>">
                      <input type="hidden" name="quantity" value="1">
                      <button type="submit"
                              class="btn-rwanda-secondary py-2 px-3 rounded-lg text-sm hover:shadow-lg transform hover:-translate-y-0.5 transition-all duration-200">
                        🛒
                      </button>
                    </form>
                  <% } %>
                </div>
              </div>
            </div>
          <% }); %>
        <% } else { %>
          <!-- Empty State for Featured Products -->
          <div class="col-span-full text-center py-16">
            <div class="w-32 h-32 bg-neutral-200 rounded-full flex items-center justify-center text-6xl mx-auto mb-6">
              🛍️
            </div>
            <h3 class="text-2xl font-bold text-neutral-900 mb-4">Featured Products Coming Soon</h3>
            <p class="text-neutral-600 mb-6">We're working with suppliers to bring you featured products</p>
            <a href="/products" class="btn-rwanda">Browse All Products</a>
          </div>
        <% } %>
      </div>
    </div>
  </div>
</section>

<%- include('../partials/footer') %>